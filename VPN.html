<h2 id="HowTomakeaVPNGatewayinQubes">How To make a VPN Gateway in Qubes</h2>
<p>The simplest case if you set up a VPN connection using the Network Manager inside one of your VMs. Setting up such a connection is really not Qubes specific and it is documented in Your Operating system documentation. If you using the Qubes default Guest OS (Fedora): <a href="http://docs.fedoraproject.org/en-US/Fedora/18/html/System_Administrators_Guide/sec-Establishing_a_VPN_Connection.html">â€‹Establishing a VPN Connection</a></p>
<p>The Qubes specific part is choose the right VM for the VPN client:</p>
<h3 id="NetVM">NetVM</h3>
<p>The simplest case if you set up a VPN connection using the Network Manager inside your NetVM. Because the <a href="/wiki/wiki/NetworkManager">NetworkManager?</a> already started you are ready to set up your VPN connection. However this has some disadvantages:</p>
<ul>
<li>You have to place (and probably save) Your VPN credentials inside the NetVM wich is directly connected to the outside world</li>
<li>All your AppVMs wich are connected to the NetVM will be connected to the VPN (by default)</li>
</ul>
<h3 id="ProxyVM">ProxyVM</h3>
<p>One of the best thing in Qubes that you can use a special type of VMs called ProxyVM (or FirewallVM). The special thing is that your AppVMs see this as a NetVM, and the NetVMs see it as an AppVM. Because of that You can place a ProxyVM between your AppVMs and Your NetVM. This is how the default firewall VM is working.</p>
<p>Using a ProxyVM to set up a VPN client will gives you the ability to:</p>
<ul>
<li>Separate your VPN credentials from Your AppVM data.</li>
<li>You can easily control which of your AppVMs are connected to your VPN by simply set it as a NetVM of the desired AppVM.</li>
</ul>
<p><strong>To setup a ProxyVM as a VPN gateway you should:</strong></p>
<ol>
<li>check (<code>rpm -q  qubes-core-vm</code>) if you have the package <strong>qubes-core-vm</strong> version <strong>2.1.36</strong> (or later)</li>
<li>create a new VM and check the ProxyVM radio button</li>
</ol>
<p><a href="/wiki/attachment/wiki/VPN/Create_New_VM.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;Create_New_VM.png&quot; attached to VPN" alt="No image &quot;Create_New_VM.png&quot; attached to VPN" /></a></p>
<ol start="3">
<li>add the network-manager service to this new VM</li>
</ol>
<p><a href="/wiki/attachment/wiki/VPN/Settings-services.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;Settings-services.png&quot; attached to VPN" alt="No image &quot;Settings-services.png&quot; attached to VPN" /></a></p>
<ol start="4">
<li>set up Your VPN as described in the Network Manager documentation linked above.</li>
</ol>
<ol start="5">
<li>connect your AppVMs to use the new VM as a NetVM.</li>
</ol>
<p><a href="/wiki/attachment/wiki/VPN/Settings-NetVM.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;Settings-NetVM.png&quot; attached to VPN" alt="No image &quot;Settings-NetVM.png&quot; attached to VPN" /></a></p>
<h3 id="AppVM">AppVM</h3>
<p>While the Network Manager is not started here (for a good reason) You can configure any kind of VPN client in your AppVM as well, however it is only suggested if you have to use a special VPN client.</p>
