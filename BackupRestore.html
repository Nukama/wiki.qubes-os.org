<h1 id="BackupRestoreMigrationTools">Backup, Restore, Migration Tools</h1>
<p>Qubes supports easy backups and restores of your VMs, and specifically very easy migration between two systems.</p>
<p>There are currently two command-line tools for this: <code>qvm-backup</code> and <code>qvm-backup-restore</code>, both of which are available in Qubes Alpha 2 (qubes-core-dom0 &gt;= 1.1.8). Users of Qubes Alpha 1 can still download the <code>qvm-backup</code> too <a href="http://qubes-os.org/yum/misc/qvm-backup">â€‹here</a> and use it to make a full backup of their system, and later restore it on Qubes Alpha 2, using qvm-backup-restore (the latter is not avilable on Alpha 1).</p>
<h2 id="MakingafullbackupofyourVMs">Making a full backup of your VMs</h2>
<ol>
<li>Mount the external media on which to place the backup:</li>
</ol>
<pre class="wiki"><code>mount /dev/&lt;backup_device&gt; /mnt/backup</code></pre>
<p><code></code><code>Note:</code><code></code> It's strongly recommended to use encrypted media for the backup (<code>qvm-backup</code> will not encrypt the backup). One can use e.g. LUKS for full encryption (type: <code>man cryptsetup</code> for details), in which case the <code>/dev/&lt;backup_device&gt;</code> would be something like <code>/dev/mapper/backup</code> -- a diskmapper device created by cryptsetup from the actual encrypted media.</p>
<ol start="2">
<li>Do the backup:</li>
</ol>
<pre class="wiki"><code>qvm-backup /mnt/backup</code></pre>
<p>The <code>qvm-backup</code> tool will take care about backing up the VMs configuration, and all your AppVMs private storages, and, if necessary, will also backup any custom templates or netvms that any of your AppVMs might be using.</p>
<h2 id="RestoringVMsfromabackup">Restoring VMs from a backup</h2>
<ol>
<li>Mount the media with a backup:</li>
</ol>
<ol start="2">
<li>Do the restore:</li>
</ol>
<pre class="wiki"><code>qvm-backup-restore /mnt/backup/&lt;specific_backup_dir&gt;</code></pre>
<p>The <code>qvm-backup-restore</code> tool will restore all the VMs (and any backed up custom template VMs), update Qubes database, and will add appmenus for the restored VMs. Your existing VMs will not be removed, unless there was a name conflict, i.e. there existed a VM with the same name on the host and in the backup. In this case, <code>qvm-backup-restore</code> will refuse to continue, and will ask you to remove the conflicting VM from the host first.</p>
