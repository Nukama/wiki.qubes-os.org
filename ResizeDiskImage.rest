Resizing Disk Image
-------------------

| There are several disk images which can be easily extended.
|  But pay attention to the overall consumed space of your sparse disk
images.

Private disk image
~~~~~~~~~~~~~~~~~~

| 1048576 MB is the maximum size which can be assigned to a private
storage through qubes-manager.

To grow the private disk image of a AppVM beyond this limit
`qubes-grow-private </wiki/Dom0Tools/QvmGrowPrivate>`__ can be used:

.. code:: wiki

    qvm-grow-private <vm-name> <size>

Note: Size is the target size (i.e. 4096MB or 16GB, ...), not the size
to add to the existing disk.

Note2: If once the VM is started, the disk is has not been increased,
you can issue in the VM's terminal:

.. code:: wiki

    sudo resize2fs /dev/xvdb

HVM disk image
~~~~~~~~~~~~~~

In this example we will grow the disk image of an HVM to 30GB.

First, stop/shutdown the HVM.

Then, from a Dom0 terminal (in KDE: System Tools -> Terminal Emulator)
do the following:

.. code:: wiki

    cd /var/lib/qubes/appvms/<yourHVM>/
    ls -lh root.img  (<--verify current size of disk image)
    truncate -s 30GB root.img
    ls -lh root.img  (<--verify new size of disk image)

The partition table and file-system must be adjusted after this change:

Windows 7
^^^^^^^^^

#. Click Start
#. type "diskmgmt.msc" - this takes you to Disk Management
#. Right-click on your existing volume, select "Extend Volume..."
#. Click through the wizard.

No reboot required.

FreeBSD
^^^^^^^

.. code:: wiki

    gpart recover ada0
    sysctl kern.geom.debugflags=0x10
    gpart resize -i index ada0
    zpool online -e poolname ada0

