<h1 id="UsingDisposableVMs">Using Disposable VMs</h1>
<h2 id="Background">Background</h2>
<p>See <a href="http://theinvisiblethings.blogspot.com/2010/06/disposable-vms.html">â€‹this article</a> for a background on why would one want to use a Disposable VM and what it is.</p>
<h2 id="OpeningafileinaDisposableVMviaGUI">Opening a file in a Disposable VM (via GUI)</h2>
<p>In some AppVM, right click on the file you wish to open in a Disposable VM (in the Nautilus file manager), then choose Scripts -&gt; Open in Disposable VM. Wait a few seconds and an default application for this file type should appear displaying the file content. This app is running in a whole new VM -- a disposable VM created for the purpose of view this very file. Once you close the viewing application then whole Disposable VM will get destroyed.</p>
<p><a href="/wiki/attachment/wiki/DisposableVms/r1-open-in-dispvm-1.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;r1-open-in-dispvm-1.png&quot; attached to DisposableVms" alt="No image &quot;r1-open-in-dispvm-1.png&quot; attached to DisposableVms" /></a> <a href="/wiki/attachment/wiki/DisposableVms/r1-open-in-dispvm-2.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;r1-open-in-dispvm-2.png&quot; attached to DisposableVms" alt="No image &quot;r1-open-in-dispvm-2.png&quot; attached to DisposableVms" /></a></p>
<h2 id="OpeningafreshwebbrowserinstanceinanewDisposableVM">Opening a fresh web browser instance in a new Disposable VM</h2>
<p>Sometimes it is convenient to open a fresh instance of Firefox within a new fresh Disposable VM. This can be easily done by using the Start Menu: just go to Start -&gt; Disposable VM -&gt; Firefox and wait a few seconds until a web browser starts. Once you close the viewing application then whole Disposable VM will get destroyed.</p>
<p><a href="/wiki/attachment/wiki/DisposableVms/r1-open-in-dispvm-3.png"><img src="/wiki/chrome/common/attachment.png" title="No image &quot;r1-open-in-dispvm-3.png&quot; attached to DisposableVms" alt="No image &quot;r1-open-in-dispvm-3.png&quot; attached to DisposableVms" /></a></p>
<h2 id="OpeningafileinaDisposableVMviacommandlinefromAppVM">Opening a file in a Disposable VM via command line (from AppVM)</h2>
<p>Use the <code>qvm-open-in-dvm</code> command line (from your AppVM), e.g.:</p>
<pre class="wiki"><code>[user@work-pub ~]$ qvm-open-in-dvm Downloads/apple-sandbox.pdf</code></pre>
<p>The qvm-open-in-dvm will not exit until you close the application in the Disposable VM.</p>
<h2 id="StartinganarbitraryapplicationinadisposableVMviacommandlinefromDom0">Starting an arbitrary application in a disposable VM via command line (from Dom0)</h2>
<p><strong>Note:</strong> Normally there should be no need for doing this -- this is just for Qubes hackers ;)</p>
<pre class="wiki"><code>[joanna@dom0 ~]$ echo gnome-terminal | /usr/lib/qubes/qfile-daemon-dvm qubes.VMShell dom0 DEFAULT red</code></pre>
<p>In fact the Disposable VM appmenu used for starting Firefox contains a very similar command to the above. Please note, however, that it generally makes little sense to start any other application other than a Web Browser this way...</p>
<h2 id="StartinganarbitraryprograminaDisposableVMfromanAppVM">Starting an arbitrary program in a Disposable VM from an AppVM</h2>
<p>Sometimes it might be useful to start an arbitrary program, such as e.g. terminal in an Disposable VM from an AppVM. This could be simply done this way:</p>
<pre class="wiki"><code>[user@vault ~]$ qvm-run &#39;$dispvm&#39; gnome-terminal</code></pre>
<p>Note the above command is issued in an AppVM, not in Dom0. The created Disposable VM can be normally accessed via other tools, such as e.g. <code>qvm-copy-to-vm</code>, using its 'dispX' name, as shown by the Qubes Manager or <code>qvm-ls</code> tools. The created Disposable VM will inherit firewall settings of the ancestor VM, which is useful in some cases (e.g. when the original AppVM had networking cut off).</p>
<h2 id="Usinganon-defaulttemplateasabasisforDisposableVM">Using a non-default template as a basis for Disposable VM</h2>
<p>In some situations it might be beneficial to use a non-default template as a basis for Disposable VM. One example is to use a less-trusted template with some less trusted, 3rd party, often unsigned, applications installed, such as e.g. 3rd part printer drivers.</p>
<p>In order to regenerate Disposable VM &quot;snapshot&quot; (called 'savefile' on Qubes) one can conveniently use the following command in Dom0:</p>
<pre class="wiki"><code>[joanna@dom0 ~]$ qvm-create-default-dvm &lt;custom-template-name&gt;</code></pre>
<p>This would create a new Disposable VM savefile based on the custom template. Now, whenever one opens a file (from any AppVM) in a Disposable VM, a Disposable VM based on this template will be used.</p>
<p>One can easily verify if the new Disposable VM template is indeed based on a custom template (in the example below the template called &quot;f17-yellow&quot; was used as a basis for the Disposable VM):</p>
<pre class="wiki"><code>[joanna@dom0 ~]$ ll /var/lib/qubes/dvmdata/
total 0
lrwxrwxrwx 1 joanna joanna 45 Mar 11 13:59 default_dvm.conf -&gt; /var/lib/qubes/appvms/f17-yellow-dvm/dvm.conf
lrwxrwxrwx 1 joanna joanna 49 Mar 11 13:59 default_savefile -&gt; /var/lib/qubes/appvms/f17-yellow-dvm/dvm-savefile
lrwxrwxrwx 1 joanna joanna 47 Mar 11 13:59 savefile_root -&gt; /var/lib/qubes/vm-templates/f17-yellow/root.img</code></pre>
